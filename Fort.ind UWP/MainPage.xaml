<Page
    x:Class="Fort.ind_UWP.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Fort.ind_UWP"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Background="Transparent">

    <Page.Resources>
        <!-- App Background - Windows 10 Settings style acrylic -->
        <AcrylicBrush x:Key="AppAcrylicBrush"
                      BackgroundSource="HostBackdrop"
                      TintColor="{ThemeResource SystemChromeMediumLowColor}"
                      TintOpacity="0.8"
                      TintLuminosityOpacity="0.85"
                      FallbackColor="{ThemeResource SystemChromeMediumLowColor}"/>

        <!-- NavigationView Pane Acrylic - matches Windows 10 Settings sidebar -->
        <AcrylicBrush x:Key="NavigationViewExpandedPaneBackground"
                      BackgroundSource="HostBackdrop"
                      TintColor="{ThemeResource SystemChromeMediumColor}"
                      TintOpacity="0.9"
                      TintLuminosityOpacity="0.8"
                      FallbackColor="{ThemeResource SystemChromeMediumColor}"/>

        <!-- Card Background - more prominent acrylic effect -->
        <AcrylicBrush x:Key="CardAcrylicBrush"
                      BackgroundSource="HostBackdrop"
                      TintColor="{ThemeResource SystemChromeMediumHighColor}"
                      TintOpacity="0.7"
                      TintLuminosityOpacity="0.85"
                      FallbackColor="{ThemeResource SystemChromeMediumHighColor}"/>
    </Page.Resources>

    <Grid Background="{StaticResource AppAcrylicBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="32"/>
            <RowDefinition Height="137*"/>
            <RowDefinition Height="347*"/>
        </Grid.RowDefinitions>

        <!-- Custom Title Bar Area -->
        <Grid x:Name="AppTitleBar" 
              Grid.Row="0" 
              Background="Transparent">
            <TextBlock Text="Fort.ind"
                       VerticalAlignment="Center"
                       Margin="12,0,0,0"
                       FontSize="12"
                       Opacity="0.8"/>
        </Grid>

        <!-- Main Content -->
        <NavigationView x:Name="NavView"
                         Grid.Row="1"
                         PaneDisplayMode="LeftCompact"
                         CompactModeThresholdWidth="640"
                         ExpandedModeThresholdWidth="1008"
                         CompactPaneLength="48"
                         OpenPaneLength="320"
                         IsBackButtonVisible="Collapsed"
                         IsSettingsVisible="True"
                         IsPaneToggleButtonVisible="True"
                         IsPaneOpen="False"
                         ItemInvoked="NavView_ItemInvoked"
                         Loaded="NavView_Loaded"
                         Background="Transparent" Grid.RowSpan="2">

            <NavigationView.Resources>
                <x:Double x:Key="NavigationViewCompactPaneLength">48</x:Double>
                <Thickness x:Key="NavigationViewItemIconBoxMargin">14,12,14,12</Thickness>
            </NavigationView.Resources>

            <NavigationView.AutoSuggestBox>
                <AutoSuggestBox x:Name="NavSearchBox"
                                PlaceholderText="Search..."
                                QueryIcon="Find"
                                MaxSuggestionListHeight="400"
                                TextChanged="NavSearchBox_TextChanged"
                                QuerySubmitted="NavSearchBox_QuerySubmitted"
                                SuggestionChosen="NavSearchBox_SuggestionChosen">
                    <AutoSuggestBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" Spacing="10" Padding="0,4">
                                <FontIcon Glyph="{Binding Icon}"
                                          FontSize="16"
                                          VerticalAlignment="Center"
                                          Opacity="0.8"/>
                                <StackPanel VerticalAlignment="Center">
                                    <TextBlock Text="{Binding Title}"/>
                                    <TextBlock Text="{Binding Category}"
                                               Style="{ThemeResource CaptionTextBlockStyle}"
                                               Opacity="0.6"/>
                                </StackPanel>
                            </StackPanel>
                        </DataTemplate>
                    </AutoSuggestBox.ItemTemplate>
                </AutoSuggestBox>
            </NavigationView.AutoSuggestBox>

            <NavigationView.MenuItems>
                <NavigationViewItem Content="Home" Tag="LatestNews">
                    <NavigationViewItem.Icon>
                        <SymbolIcon Symbol="Home"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
                <NavigationViewItem Content="Games" Tag="Games">
                    <NavigationViewItem.Icon>
                        <SymbolIcon Symbol="Play"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
                <NavigationViewItem Content="Beta Programs" Tag="Betas">
                    <NavigationViewItem.Icon>
                        <SymbolIcon Symbol="PreviewLink"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
                <NavigationViewItem x:Name="ProfileNavItem" Content="Your Profile" Tag="Profile">
                    <NavigationViewItem.Icon>
                        <SymbolIcon Symbol="Contact"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
                <NavigationViewItem Content="Social" Tag="Social">
                    <NavigationViewItem.Icon>
                        <SymbolIcon Symbol="People"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
                <NavigationViewItem Content="About" Tag="About">
                    <NavigationViewItem.Icon>
                        <SymbolIcon Symbol="Help"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
            </NavigationView.MenuItems>

            <!-- Content Area -->
            <Grid Background="Transparent">
                <!-- Frame for page navigation -->
                <Frame x:Name="ContentFrame" Visibility="Collapsed"/>

                <ScrollViewer x:Name="ContentScrollViewer">
                    <StackPanel x:Name="ContentPanel" Padding="24">
                        <!-- Latest News Content (default view) -->
                        <StackPanel x:Name="LatestNewsPanel" Visibility="Visible">
                            <TextBlock Text="Welcome to Fort.ind"
                                       FontSize="32"
                                       FontWeight="Bold"
                                       Margin="0,0,0,10"/>

                            <TextBlock Text="Check back here for the latest updates and announcements."
                                       FontSize="16"
                                       Opacity="0.7"
                                       Margin="0,0,0,24"/>

                            <!-- News Cards Grid -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="16"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- News Card 1 -->
                                <Grid Grid.Column="0" 
                                      Background="{StaticResource CardAcrylicBrush}"
                                      CornerRadius="8"
                                      Padding="20"
                                      MinHeight="180">
                                    <StackPanel>
                                        <TextBlock Text="📰 Welcome!"
                                                   FontSize="14"
                                                   Opacity="0.6"
                                                   Margin="0,0,0,8"/>
                                        <TextBlock Text="welcome to the FIRST actual public beta of this app!"
                                                   FontSize="20"
                                                   FontWeight="SemiBold"
                                                   Margin="0,0,0,12"/>
                                        <TextBlock Text="currently we have finished the base structure of the app :p more on the way"
                                                   TextWrapping="Wrap"
                                                   FontSize="14"
                                                   Opacity="0.8"
                                                   Margin="0,0,0,12"/>
                                        <TextBlock Text="Just now"
                                                   FontSize="12"
                                                   Opacity="0.5"/>
                                    </StackPanel>
                                </Grid>

                                <!-- News Card 2 -->
                                <Grid Grid.Column="2" 
                                      Background="{StaticResource CardAcrylicBrush}"
                                      CornerRadius="8"
                                      Padding="20"
                                      MinHeight="180">
                                    <StackPanel>
                                        <TextBlock Text="🎮 soon! :3"
                                                   FontSize="14"
                                                   Opacity="0.6"
                                                   Margin="0,0,0,8"/>
                                        <TextBlock Text="New Features Ahead"
                                                   FontSize="20"
                                                   FontWeight="SemiBold"
                                                   Margin="0,0,0,12"/>
                                        <TextBlock Text="soon you will be able to manage your fort.ind account, view posts from social and play your games from fort1nd.com on windows! if you want to use the full experience for now go to fort1nd.com"
                                                   TextWrapping="Wrap"
                                                   FontSize="14"
                                                   Opacity="0.8"
                                                   Margin="0,0,0,12"/>
                                        <TextBlock Text="in the future (maybe subject to change)"
                                                   FontSize="12"
                                                   Opacity="0.5"/>
                                    </StackPanel>
                                </Grid>
                            </Grid>
                        </StackPanel>

                        <!-- Games Content -->
                        <StackPanel x:Name="GamesPanel" Visibility="Collapsed">
                            <TextBlock Text="Games"
                                       FontSize="32"
                                       FontWeight="Bold"
                                       Margin="0,0,0,10"/>

                            <TextBlock Text="Visit https://www.fort1nd.com to explore our games"
                                       FontSize="18"
                                       TextWrapping="Wrap"/>
                        </StackPanel>

                        <!-- Betas Content -->
                        <StackPanel x:Name="BetasPanel" Visibility="Collapsed">
                            <TextBlock Text="Beta Programs"
                                       FontSize="32"
                                       FontWeight="Bold"
                                       Margin="0,0,0,10"/>

                            <TextBlock Text="Access beta versions and early features (coming soon)"
                                       FontSize="18"
                                       TextWrapping="Wrap"/>
                        </StackPanel>

                        <!-- Profile Content is now handled by ProfilePage via Frame -->

                        <!-- Social Content -->
                        <StackPanel x:Name="SocialPanel" Visibility="Collapsed">
                            <TextBlock Text="Social"
                                       FontSize="32"
                                       FontWeight="Bold"
                                       Margin="0,0,0,10"/>

                            <TextBlock Text="Social features coming soon"
                                       FontSize="18"
                                       TextWrapping="Wrap"/>
                        </StackPanel>

                        <!-- About Content -->
                        <StackPanel x:Name="AboutPanel" Visibility="Collapsed">
                            <TextBlock Text="About Fort.ind Desktop"
                                       FontSize="32"
                                       FontWeight="Bold"
                                       Margin="0,0,0,10"/>

                            <TextBlock Text="Version 0.5 Beta"
                                       FontSize="18"
                                       TextWrapping="Wrap"/>
                        </StackPanel>

                        <!-- Settings Content -->
                        <StackPanel x:Name="SettingsPanel" Visibility="Collapsed">
                            <TextBlock Text="Settings"
                                       FontSize="32"
                                       FontWeight="Bold"
                                       Margin="0,0,0,4"/>

                            <TextBlock Text="Configure your application preferences"
                                       FontSize="14"
                                       Opacity="0.6"
                                       Margin="0,0,0,24"/>

                            <StackPanel MaxWidth="700" HorizontalAlignment="Stretch" Spacing="4">
                                <StackPanel.ChildrenTransitions>
                                    <TransitionCollection>
                                        <EntranceThemeTransition FromVerticalOffset="40"/>
                                        <RepositionThemeTransition/>
                                    </TransitionCollection>
                                </StackPanel.ChildrenTransitions>

                                <!-- ═══ Data Storage ═══ -->
                                <Grid Background="{StaticResource CardAcrylicBrush}"
                                      Padding="16,14"
                                      PointerEntered="SettingsRow_PointerEntered"
                                      PointerExited="SettingsRow_PointerExited"
                                      Tapped="StorageHeader_Tapped">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid Width="36" Height="36" CornerRadius="4"
                                          Background="{ThemeResource SystemControlBackgroundBaseLowBrush}">
                                        <FontIcon Glyph="&#xEDA2;" FontSize="16"
                                                  HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Grid>
                                    <StackPanel Grid.Column="1" Margin="16,0,0,0" VerticalAlignment="Center">
                                        <TextBlock Text="Data Storage" FontSize="14" FontWeight="SemiBold"/>
                                        <TextBlock Text="Manage local storage and view account data"
                                                   FontSize="12" Opacity="0.6"/>
                                    </StackPanel>
                                    <FontIcon x:Name="StorageChevron" Grid.Column="2" Glyph="&#xE76C;"
                                              FontSize="12" Opacity="0.4" VerticalAlignment="Center"
                                              RenderTransformOrigin="0.5,0.5">
                                        <FontIcon.RenderTransform>
                                            <RotateTransform x:Name="StorageChevronRotation" Angle="0"/>
                                        </FontIcon.RenderTransform>
                                    </FontIcon>
                                </Grid>
                                <StackPanel x:Name="StorageContent" Visibility="Collapsed"
                                            Background="{StaticResource CardAcrylicBrush}"
                                            Padding="20,16" Margin="0,-2,0,0">
                                    <StackPanel.ChildrenTransitions>
                                        <TransitionCollection>
                                            <EntranceThemeTransition FromVerticalOffset="20"/>
                                        </TransitionCollection>
                                    </StackPanel.ChildrenTransitions>
                                    <StackPanel Spacing="8">
                                        <StackPanel Orientation="Horizontal" Spacing="8">
                                            <FontIcon Glyph="&#xE8B7;" FontSize="14" Opacity="0.7"/>
                                            <TextBlock Text="Local JSON Storage"
                                                       FontSize="13" FontWeight="SemiBold"/>
                                        </StackPanel>
                                        <TextBlock Text="Your account data is stored locally on this device as JSON files."
                                                   FontSize="12" Opacity="0.7" TextWrapping="Wrap"
                                                   Margin="0,0,0,4"/>
                                        <TextBlock x:Name="StoragePathText"
                                                   FontSize="11" Opacity="0.5" TextWrapping="Wrap"/>
                                        <TextBlock x:Name="UserCountText"
                                                   FontSize="12" Opacity="0.7"/>
                                        <StackPanel Orientation="Horizontal" Spacing="6"
                                                    Margin="0,8,0,0" Opacity="0.5">
                                            <FontIcon Glyph="&#xE946;" FontSize="11"/>
                                            <TextBlock Text="SQLite database &amp; server sync coming soon!"
                                                       FontSize="11" FontStyle="Italic"/>
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>

                                <!-- ═══ Live Tile ═══ -->
                                <Grid Background="{StaticResource CardAcrylicBrush}"
                                      Padding="16,14"
                                      PointerEntered="SettingsRow_PointerEntered"
                                      PointerExited="SettingsRow_PointerExited"
                                      Tapped="TileHeader_Tapped">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid Width="36" Height="36" CornerRadius="4"
                                          Background="{ThemeResource SystemControlBackgroundBaseLowBrush}">
                                        <FontIcon Glyph="&#xE77F;" FontSize="16"
                                                  HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Grid>
                                    <StackPanel Grid.Column="1" Margin="16,0,0,0" VerticalAlignment="Center">
                                        <TextBlock Text="Live Tile" FontSize="14" FontWeight="SemiBold"/>
                                        <TextBlock Text="Refresh or clear your Start menu tile"
                                                   FontSize="12" Opacity="0.6"/>
                                    </StackPanel>
                                    <FontIcon x:Name="TileChevron" Grid.Column="2" Glyph="&#xE76C;"
                                              FontSize="12" Opacity="0.4" VerticalAlignment="Center"
                                              RenderTransformOrigin="0.5,0.5">
                                        <FontIcon.RenderTransform>
                                            <RotateTransform x:Name="TileChevronRotation" Angle="0"/>
                                        </FontIcon.RenderTransform>
                                    </FontIcon>
                                </Grid>
                                <StackPanel x:Name="TileContent" Visibility="Collapsed"
                                            Background="{StaticResource CardAcrylicBrush}"
                                            Padding="20,16" Margin="0,-2,0,0">
                                    <StackPanel.ChildrenTransitions>
                                        <TransitionCollection>
                                            <EntranceThemeTransition FromVerticalOffset="20"/>
                                        </TransitionCollection>
                                    </StackPanel.ChildrenTransitions>
                                    <StackPanel Orientation="Horizontal" Spacing="12">
                                        <Button x:Name="RefreshTileButton"
                                                Click="RefreshTileButton_Click"
                                                Style="{StaticResource ButtonRevealStyle}">
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <FontIcon Glyph="&#xE72C;" FontSize="14"/>
                                                <TextBlock Text="Refresh Live Tile"/>
                                            </StackPanel>
                                        </Button>
                                        <Button x:Name="ClearTileButton"
                                                Click="ClearTileButton_Click"
                                                Style="{StaticResource ButtonRevealStyle}">
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <FontIcon Glyph="&#xE74D;" FontSize="14"/>
                                                <TextBlock Text="Clear Live Tile"/>
                                            </StackPanel>
                                        </Button>
                                    </StackPanel>
                                </StackPanel>

                                <!-- ═══ Welcome Dialog ═══ -->
                                <Grid Background="{StaticResource CardAcrylicBrush}"
                                      Padding="16,14"
                                      PointerEntered="SettingsRow_PointerEntered"
                                      PointerExited="SettingsRow_PointerExited"
                                      Tapped="WelcomeHeader_Tapped">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid Width="36" Height="36" CornerRadius="4"
                                          Background="{ThemeResource SystemControlBackgroundBaseLowBrush}">
                                        <FontIcon Glyph="&#xEB51;" FontSize="16"
                                                  HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Grid>
                                    <StackPanel Grid.Column="1" Margin="16,0,0,0" VerticalAlignment="Center">
                                        <TextBlock Text="Welcome Dialog" FontSize="14" FontWeight="SemiBold"/>
                                        <TextBlock Text="Reset the first-run welcome experience"
                                                   FontSize="12" Opacity="0.6"/>
                                    </StackPanel>
                                    <FontIcon x:Name="WelcomeChevron" Grid.Column="2" Glyph="&#xE76C;"
                                              FontSize="12" Opacity="0.4" VerticalAlignment="Center"
                                              RenderTransformOrigin="0.5,0.5">
                                        <FontIcon.RenderTransform>
                                            <RotateTransform x:Name="WelcomeChevronRotation" Angle="0"/>
                                        </FontIcon.RenderTransform>
                                    </FontIcon>
                                </Grid>
                                <StackPanel x:Name="WelcomeContent" Visibility="Collapsed"
                                            Background="{StaticResource CardAcrylicBrush}"
                                            Padding="20,16" Margin="0,-2,0,0">
                                    <StackPanel.ChildrenTransitions>
                                        <TransitionCollection>
                                            <EntranceThemeTransition FromVerticalOffset="20"/>
                                        </TransitionCollection>
                                    </StackPanel.ChildrenTransitions>
                                    <StackPanel Spacing="10">
                                        <TextBlock Text="The welcome dialog appears the first time you open the app."
                                                   FontSize="12" Opacity="0.7" TextWrapping="Wrap"/>
                                        <Button x:Name="ResetWelcomeButton"
                                                Click="ResetWelcomeButton_Click"
                                                Style="{StaticResource ButtonRevealStyle}">
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <FontIcon Glyph="&#xE72C;" FontSize="14"/>
                                                <TextBlock Text="Show Welcome Dialog Again"/>
                                            </StackPanel>
                                        </Button>
                                    </StackPanel>
                                </StackPanel>

                                <!-- ═══ About ═══ -->
                                <Grid Background="{StaticResource CardAcrylicBrush}"
                                      Padding="16,14"
                                      PointerEntered="SettingsRow_PointerEntered"
                                      PointerExited="SettingsRow_PointerExited"
                                      Tapped="AboutHeader_Tapped">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid Width="36" Height="36" CornerRadius="4"
                                          Background="{ThemeResource SystemControlBackgroundBaseLowBrush}">
                                        <FontIcon Glyph="&#xE946;" FontSize="16"
                                                  HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Grid>
                                    <StackPanel Grid.Column="1" Margin="16,0,0,0" VerticalAlignment="Center">
                                        <TextBlock Text="About" FontSize="14" FontWeight="SemiBold"/>
                                        <TextBlock Text="Version info, credits, and more"
                                                   FontSize="12" Opacity="0.6"/>
                                    </StackPanel>
                                    <FontIcon x:Name="AboutChevron" Grid.Column="2" Glyph="&#xE76C;"
                                              FontSize="12" Opacity="0.4" VerticalAlignment="Center"
                                              RenderTransformOrigin="0.5,0.5">
                                        <FontIcon.RenderTransform>
                                            <RotateTransform x:Name="AboutChevronRotation" Angle="0"/>
                                        </FontIcon.RenderTransform>
                                    </FontIcon>
                                </Grid>
                                <StackPanel x:Name="AboutContent" Visibility="Collapsed"
                                            Background="{StaticResource CardAcrylicBrush}"
                                            Padding="20,16" Margin="0,-2,0,0">
                                    <StackPanel.ChildrenTransitions>
                                        <TransitionCollection>
                                            <EntranceThemeTransition FromVerticalOffset="20"/>
                                        </TransitionCollection>
                                    </StackPanel.ChildrenTransitions>
                                    <StackPanel Spacing="8">
                                        <TextBlock Text="Fort.ind Desktop for UWP"
                                                   FontSize="14" FontWeight="SemiBold"/>
                                        <TextBlock Text="Version 0.5 Beta"
                                                   FontSize="12" Opacity="0.6"/>
                                        <Button x:Name="AboutButton"
                                                Click="AboutButton_Click"
                                                Margin="0,4,0,0"
                                                Style="{StaticResource ButtonRevealStyle}">
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <FontIcon Glyph="&#xE946;" FontSize="14"/>
                                                <TextBlock Text="View Details"/>
                                            </StackPanel>
                                        </Button>
                                    </StackPanel>
                                </StackPanel>

                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </Grid>

        </NavigationView>
    </Grid>
</Page>
